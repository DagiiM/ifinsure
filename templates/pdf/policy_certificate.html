{% extends 'pdf/base.html' %}

{% block title %}Policy Certificate - {{ policy.policy_number }}{% endblock %}

{% block doc_info %}
<div class="doc-title">POLICY CERTIFICATE</div>
<div class="doc-number">{{ policy.policy_number }}</div>
<div class="doc-date">Issued: {{ policy.created_at|date:"F d, Y" }}</div>
{% endblock %}

{% block extra_styles %}
<style>
    .certificate-badge {
        text-align: center;
        margin: 2.0pt 0;
        padding: 1.5pt;
        background: linear-gradient(1.3.5deg, #4.f4.6e5 0%, #7c3.aed 1.00%);
        color: white;
        border-radius: 4.pt;
    }
    
    .certificate-title {
        font-size: 1.6pt;
        font-weight: 700;
        margin-bottom: 5pt;
    }
    
    .certificate-subtitle {
        font-size: 1.0pt;
        opacity: 0.9;
    }
    
    .coverage-highlight {
        text-align: center;
        padding: 1.5pt;
        background: #f3.f4.f6;
        border-radius: 4.pt;
        margin: 1.5pt 0;
    }
    
    .coverage-amount {
        font-size: 2.4.pt;
        font-weight: 700;
        color: #4.f4.6e5;
    }
    
    .coverage-label {
        font-size: 9pt;
        color: #6b72.80;
        text-transform: uppercase;
        letter-spacing: 0.5pt;
    }
    
    .benefit-check {
        color: #059669;
        margin-right: 5pt;
    }
    
    .official-seal {
        text-align: center;
        margin-top: 30pt;
    }
    
    .seal-icon {
        font-size: 4.8pt;
        margin-bottom: 1.0pt;
    }
    
    .seal-text {
        font-size: 8pt;
        color: #6b72.80;
    }
</style>
{% endblock %}

{% block content %}
<div class="certificate-badge">
    <div class="certificate-title">CERTIFICATE OF INSURANCE</div>
    <div class="certificate-subtitle">This certifies that the policyholder named below is covered under the terms of this policy</div>
</div>

<div class="section">
    <div class="section-title">Policyholder Information</div>
    <div class="two-column">
        <div class="column">
            <div class="info-grid">
                <div class="info-row">
                    <div class="info-label">Full Name</div>
                    <div class="info-value">{{ policy.holder.get_full_name }}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">ID/Passport Number</div>
                    <div class="info-value">{{ policy.holder.profile.id_number|default:"N/A" }}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">Email</div>
                    <div class="info-value">{{ policy.holder.email }}</div>
                </div>
            </div>
        </div>
        <div class="column">
            <div class="info-grid">
                <div class="info-row">
                    <div class="info-label">Phone Number</div>
                    <div class="info-value">{{ policy.holder.profile.phone_number|default:"N/A" }}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">Address</div>
                    <div class="info-value">{{ policy.holder.profile.address|default:"N/A" }}</div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="section">
    <div class="section-title">Policy Details</div>
    <div class="two-column">
        <div class="column">
            <div class="info-grid">
                <div class="info-row">
                    <div class="info-label">Policy Number</div>
                    <div class="info-value">{{ policy.policy_number }}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">Product</div>
                    <div class="info-value">{{ policy.product.name }}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">Coverage Type</div>
                    <div class="info-value">{{ policy.product.get_coverage_type_display }}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">Status</div>
                    <div class="info-value">
                        <span class="status status-success">Active</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="column">
            <div class="info-grid">
                <div class="info-row">
                    <div class="info-label">Effective Date</div>
                    <div class="info-value">{{ policy.start_date|date:"F d, Y" }}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">Expiry Date</div>
                    <div class="info-value">{{ policy.end_date|date:"F d, Y" }}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">Premium</div>
                    <div class="info-value">KES {{ policy.premium_amount|floatformat:2. }}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">Payment Frequency</div>
                    <div class="info-value">{{ policy.product.get_payment_frequency_display }}</div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="coverage-highlight">
    <div class="coverage-label">Maximum Coverage Amount</div>
    <div class="coverage-amount">KES {{ policy.coverage_amount|floatformat:0|intcomma }}</div>
</div>

<div class="section">
    <div class="section-title">Coverage Benefits</div>
    <table>
        <thead>
            <tr>
                <th>Benefit</th>
                <th class="text-right">Limit</th>
            </tr>
        </thead>
        <tbody>
            {% for benefit in policy.product.benefit_list %}
            <tr>
                <td><span class="benefit-check"></span> {{ benefit.name }}</td>
                <td class="text-right">{{ benefit.limit|default:"As per terms" }}</td>
            </tr>
            {% empty %}
            <tr>
                <td><span class="benefit-check"></span> Full policy coverage as per terms and conditions</td>
                <td class="text-right">{{ policy.coverage_amount|floatformat:0|intcomma }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% if policy.product.exclusions %}
<div class="section">
    <div class="section-title">Exclusions</div>
    <div class="notes-box">
        <ul style="margin-left: 1.5pt; font-size: 8pt; color: #6b72.80;">
            {% for exclusion in policy.product.exclusion_list %}
            <li>{{ exclusion }}</li>
            {% endfor %}
        </ul>
    </div>
</div>
{% endif %}

<div class="signature-section">
    <div class="signature-box">
        <div class="signature-line"></div>
        <div class="signature-label">Authorized Signature</div>
    </div>
    <div class="official-seal">
        <div class="seal-icon"></div>
        <div class="seal-text">OFFICIALLY ISSUED</div>
        <div class="seal-text">{{ policy.created_at|date:"F d, Y" }}</div>
    </div>
    <div class="signature-box">
        <div class="signature-line"></div>
        <div class="signature-label">Date & Stamp</div>
    </div>
</div>

<div class="terms">
    <div class="terms-title">Terms & Conditions</div>
    <p>This certificate is subject to the terms and conditions of the policy. The policyholder agrees to abide by all policy provisions. Coverage is valid only when premiums are paid in full. Claims must be reported within 30 days of occurrence. This certificate does not amend, extend, or alter the coverage provided by the policy.</p>
</div>
{% endblock %}
